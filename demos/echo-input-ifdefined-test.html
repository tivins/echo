<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Echo Input ifDefined Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fafafa;
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #555;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .test-result {
            background-color: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 4px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 12px;
        }
        
        .test-result.error {
            background-color: #ffebee;
            border-color: #f44336;
        }
        
        .attribute-check {
            margin: 5px 0;
        }
        
        .attribute-check.pass {
            color: #2e7d32;
        }
        
        .attribute-check.fail {
            color: #d32f2f;
        }
        
        .html-output {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 11px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Echo Input ifDefined Test</h1>
        
        <div class="test-section">
            <h2>Test 1: With min and max attributes</h2>
            <div class="input-group">
                <echo-input
                    type="number"
                    label="With min and max"
                    min="0"
                    max="10"
                    step="0.1"
                    value="1.5"
                    id="test-with-min-max">
                </echo-input>
            </div>
            <div id="test1-results" class="test-result">
                <strong>Test 1 Results:</strong><br>
                <span id="test1-output">Running test...</span>
            </div>
            <div id="test1-html" class="html-output"></div>
        </div>
        
        <div class="test-section">
            <h2>Test 2: Without min attribute</h2>
            <div class="input-group">
                <echo-input
                    type="number"
                    label="Without min"
                    max="10"
                    step="0.1"
                    value="1.5"
                    id="test-without-min">
                </echo-input>
            </div>
            <div id="test2-results" class="test-result">
                <strong>Test 2 Results:</strong><br>
                <span id="test2-output">Running test...</span>
            </div>
            <div id="test2-html" class="html-output"></div>
        </div>
        
        <div class="test-section">
            <h2>Test 3: All attributes null</h2>
            <div class="input-group">
                <echo-input
                    type="number"
                    label="All null"
                    value="1.5"
                    id="test-all-null">
                </echo-input>
            </div>
            <div id="test3-results" class="test-result">
                <strong>Test 3 Results:</strong><br>
                <span id="test3-output">Running test...</span>
            </div>
            <div id="test3-html" class="html-output"></div>
        </div>
    </div>

    <script type="module">
        import '../dist/design-toolkit.esm.js';
        
        function checkAttribute(inputElement, attributeName, expectedValue) {
            const actualValue = inputElement.getAttribute(attributeName);
            const hasAttribute = inputElement.hasAttribute(attributeName);
            
            if (expectedValue === null) {
                return {
                    pass: !hasAttribute,
                    message: `${attributeName}: ${hasAttribute ? `"${actualValue}" (should not exist)` : 'not present ✓'}`
                };
            } else {
                return {
                    pass: actualValue === expectedValue,
                    message: `${attributeName}: "${actualValue}" (expected: "${expectedValue}")`
                };
            }
        }
        
        function getInputHTML(inputElement) {
            const attrs = [];
            for (const attr of inputElement.attributes) {
                attrs.push(`${attr.name}="${attr.value}"`);
            }
            return `<input ${attrs.join(' ')}>`;
        }
        
        function runTest(testId, expectedMin, expectedMax, expectedStep) {
            const input = document.getElementById(testId);
            const inputElement = input.shadowRoot.querySelector('input');
            
            const minCheck = checkAttribute(inputElement, 'min', expectedMin);
            const maxCheck = checkAttribute(inputElement, 'max', expectedMax);
            const stepCheck = checkAttribute(inputElement, 'step', expectedStep);
            
            const allPassed = minCheck.pass && maxCheck.pass && stepCheck.pass;
            
            const resultDiv = document.getElementById(`${testId}-results`);
            const outputSpan = document.getElementById(`${testId}-output`);
            const htmlDiv = document.getElementById(`${testId}-html`);
            
            if (allPassed) {
                resultDiv.className = 'test-result';
                outputSpan.innerHTML = '✅ All tests passed!<br>' + 
                    `<div class="attribute-check pass">${minCheck.message}</div>` +
                    `<div class="attribute-check pass">${maxCheck.message}</div>` +
                    `<div class="attribute-check pass">${stepCheck.message}</div>`;
            } else {
                resultDiv.className = 'test-result error';
                outputSpan.innerHTML = '❌ Some tests failed!<br>' + 
                    `<div class="attribute-check ${minCheck.pass ? 'pass' : 'fail'}">${minCheck.message}</div>` +
                    `<div class="attribute-check ${maxCheck.pass ? 'pass' : 'fail'}">${maxCheck.message}</div>` +
                    `<div class="attribute-check ${stepCheck.pass ? 'pass' : 'fail'}">${stepCheck.message}</div>`;
            }
            
            htmlDiv.textContent = getInputHTML(inputElement);
        }
        
        function runAllTests() {
            // Test 1: With min and max attributes
            runTest('test-with-min-max', '0', '10', '0.1');
            
            // Test 2: Without min attribute
            runTest('test-without-min', null, '10', '0.1');
            
            // Test 3: All attributes null
            runTest('test-all-null', null, null, null);
        }
        
        // Run tests after components are loaded
        setTimeout(runAllTests, 100);
    </script>
</body>
</html>
